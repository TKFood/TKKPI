<?xml version="1.0" encoding="utf-8"?>
<Report ScriptLanguage="CSharp" ReportInfo.Created="11/25/2021 16:27:50" ReportInfo.Modified="11/25/2021 16:29:07" ReportInfo.CreatorVersion="2016.4.4.0">
  <Dictionary>
    <MsSqlDataConnection Name="Connection" ConnectionString="rijcmlqHwzMSgwTFaHpjtG3vsOj8Zy6q+uhwpDsytgWqwZQZyEQUQyQ022aWUGqU90pHzzNjHuzu89K+RQ2LIBVx1fpgNkNJhwC4eetn2/Uy0fMrO7zDUE5AmRb+0bcYI+lxqpN+i5gA3VDGcwlcfm6L9ZMsLrZ3U+wEDtHCQtd9vw2XUGXUCMw2PBJjriWzSIBdyYg">
      <TableDataSource Name="Table" DataType="System.Int32" Enabled="true" SelectCommand="SELECT LA005&#13;&#10;,MB002&#13;&#10;,(SELECT ISNULL(SUM(LA016),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202012' AND LA.LA005=TEMP2.LA005) AS 'LASTMONTHACTNUMS'&#13;&#10;,(SELECT ISNULL(SUM(LA017),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202012' AND LA.LA005=TEMP2.LA005) AS 'LASTMONTHACTMONEYS'&#13;&#10;,(SELECT ISNULL(SUM(TD008),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002 AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202112' AND TD004=LA005 ) AS 'LASTMONTHNUMS'&#13;&#10;,(SELECT ISNULL(SUM(TD012),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002  AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202112' AND TD004=LA005 ) AS 'LASTMONTHMONEYS'&#13;&#10;,(SELECT ISNULL(SUM(LA016),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202101' AND LA.LA005=TEMP2.LA005) AS 'THISMONNTHACTNUMS'&#13;&#10;,(SELECT ISNULL(SUM(LA017),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202101' AND LA.LA005=TEMP2.LA005) AS 'THISMONNTHACTMONEYS'&#13;&#10;,(SELECT ISNULL(SUM(TD008),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002  AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202201' AND TD004=LA005 ) AS 'THISMONNTHNUMS'&#13;&#10;,(SELECT ISNULL(SUM(TD012),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002  AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202201' AND TD004=LA005 ) AS 'THISMONNTHMONEYS'&#13;&#10;,(SELECT ISNULL(SUM(LA016),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202102' AND LA.LA005=TEMP2.LA005) AS 'NEXTMONNTHACTNUMS'&#13;&#10;,(SELECT ISNULL(SUM(LA017),0) FROM [TK].dbo.SASLA LA WHERE LA.LA007 LIKE '1065%'  AND SUBSTRING(CONVERT(nvarchar,LA.LA015,112),1,6)='202102' AND LA.LA005=TEMP2.LA005) AS 'NEXTMONNTHACTMONEYS'&#13;&#10;,(SELECT ISNULL(SUM(TD008),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002 AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202202' AND TD004=LA005 ) AS 'NEXTMONNTHNUMS'&#13;&#10;,(SELECT ISNULL(SUM(TD012),0) FROM [TK].dbo.COPTC,[TK].dbo.COPTD WHERE TC001=TD001 AND TC002=TD002 AND TC001='A228' AND TC004='91000006' AND SUBSTRING(TD013,1,6)='202202' AND TD004=LA005 ) AS 'NEXTMONNTHMONEYS'&#13;&#10;FROM (&#13;&#10;SELECT LA005&#13;&#10;FROM (&#13;&#10;--去年的銷售商品&#13;&#10;SELECT LA005&#13;&#10;FROM [TK].dbo.SASLA &#13;&#10;WHERE LA007 LIKE '1065%' &#13;&#10;AND LA005 LIKE '4%'&#13;&#10;AND (SUBSTRING(CONVERT(nvarchar,LA015,112),1,6)='202012' OR SUBSTRING(CONVERT(nvarchar,LA015,112),1,6)='202101'  OR SUBSTRING(CONVERT(nvarchar,LA015,112),1,6)='202102' )&#13;&#10;GROUP BY LA005&#13;&#10;UNION ALL &#13;&#10;SELECT TD004&#13;&#10;FROM [TK].dbo.COPTC,[TK].dbo.COPTD&#13;&#10;WHERE TC001=TD001 &#13;&#10;AND TC002=TD002&#13;&#10;AND TC004='91000006'&#13;&#10;AND (TD004 LIKE '4%' OR TD004 LIKE '5%')&#13;&#10;AND TD004 NOT LIKE '404%'&#13;&#10;AND TC001='A228'&#13;&#10;AND (TD013 LIKE '202112%' OR TD013 LIKE '202201%'  OR TD013 LIKE '202202%' )&#13;&#10;GROUP BY TD004&#13;&#10;) AS TEMP&#13;&#10;GROUP BY LA005&#13;&#10;) AS TEMP2&#13;&#10;LEFT JOIN [TK].dbo.INVMB ON MB001=LA005&#13;&#10;ORDER BY LA005&#13;&#10;&#13;&#10;">
        <Column Name="LA005" DataType="System.String"/>
        <Column Name="MB002" DataType="System.String"/>
        <Column Name="LASTMONTHACTNUMS" DataType="System.Decimal"/>
        <Column Name="LASTMONTHACTMONEYS" DataType="System.Decimal"/>
        <Column Name="LASTMONTHNUMS" DataType="System.Decimal"/>
        <Column Name="LASTMONTHMONEYS" DataType="System.Decimal"/>
        <Column Name="THISMONNTHACTNUMS" DataType="System.Decimal"/>
        <Column Name="THISMONNTHACTMONEYS" DataType="System.Decimal"/>
        <Column Name="THISMONNTHNUMS" DataType="System.Decimal"/>
        <Column Name="THISMONNTHMONEYS" DataType="System.Decimal"/>
        <Column Name="NEXTMONNTHACTNUMS" DataType="System.Decimal"/>
        <Column Name="NEXTMONNTHACTMONEYS" DataType="System.Decimal"/>
        <Column Name="NEXTMONNTHNUMS" DataType="System.Decimal"/>
        <Column Name="NEXTMONNTHMONEYS" DataType="System.Decimal"/>
      </TableDataSource>
    </MsSqlDataConnection>
  </Dictionary>
  <ReportPage Name="Page1" Landscape="true" PaperWidth="297" PaperHeight="210">
    <ReportTitleBand Name="ReportTitle1" Width="1047.06" Height="37.8"/>
    <ColumnHeaderBand Name="ColumnHeader1" Top="42.29" Width="1047.06" Height="37.8"/>
    <DataBand Name="Data1" Top="84.59" Width="1047.06" Height="75.6"/>
  </ReportPage>
</Report>
